<!DOCTYPE html>
<html>

<head>
    <title>
        Home - Lars van Duijnhoven - Portfolio
    </title>
    <link rel="stylesheet" href="styling.css">

    <div class="navbar" id="navbar"> </div>
    <script>
        fetch('navbar.html')
            .then(response => response.text())
            .then(html => { document.getElementById('navbar').innerHTML = html; });
    </script>
    <h3 class="nav-title"> Home - Lars van Duijnhoven - Portfolio</h3>
    <div class="nav-spacer"></div>

</head>


<body>
    <div id="index">

        <H1>Welkom bij de portfolio pagina van Lars van Duijnhoven</H1>

        <p>
            Deze volledige website is gemaakt in HTML, CSS en JS. Dit houdt dus ook in dat ik geen Bootstrap of andere
            frameworks heb gebruikt (ook geen Wordpress). Dit is een bewuste keuze geweest, omdat ik het mijzelf iets
            lastiger wilde maken.
        </p>

        <div id="weather">
            <div id="description"></div>
            <h1 id="temp"></h1>
            <div id="location"></div>
        </div>
        <script lang="text/javascript">

            function drawWeather(d) {
                const tempC = d.main?.temp;
                const desc = d.weather?.[0]?.description.toLowerCase();
                const city = d.name;

                const weatherAPI = document.getElementById('weather'); // Needed for the external CSS styling of the background

                if (desc.includes("rain")) {
                    weatherAPI.classList.add("rainy");
                } else if (desc.includes("cloud")) {
                    weatherAPI.classList.add("cloudy");
                } else if (desc.includes("sun")) {
                    weatherAPI.classList.add("sunny");
                }

                // Capitalize first letter of description
                const prettyDesc = desc ? desc.charAt(0).toUpperCase() + desc.slice(1) : '';

                document.getElementById('description').textContent = prettyDesc;
                document.getElementById('temp').textContent = `${tempC}Â°C`;
                document.getElementById('location').textContent = city;
            }

            function weatherBalloon(cityID) {
                var key = '1a5da0b8583546fd82425c235b0ba355';
                fetch('https://api.openweathermap.org/data/2.5/weather?id=' + cityID +
                    '&appid=' + key + '&units=metric')
                    .then(function (resp) { return resp.json() }) // Convert data to json
                    .then(function (data) {
                        drawWeather(data)
                    })
                    .catch(function () {
                        // catch any errors
                    });
            }
            window.onload = function () {
                // weatherBalloon(2750052); // Gemeente Nijmegen
                weatherBalloon(2750053); // Nijmegen
            }
        </script>
    </div>


    <div id="nasa">

        <section class="title-section">
            <h2 id="title"></h2>
            <p id="date"></p>
            <small style="display: block;" id="copyright"></small>
        </section>

        <section id="media-section">
        </section>

        <div class="description-nasa">
            <p id="description-nasa"></p>
        </div>

        <form id="nasa-form">
            <label for="datepicker">Pick a date:
                <input id="datepicker" type="date" min="" max="">
            </label>
        </form>

        <script lang="text/javascript">
            const dateInput = document.querySelector("#datepicker");
            dateInput.addEventListener('change', (e) => {
                e.preventDefault();
                nasarequested();
            })

            function nasarequested() {
                const baseUrl = 'https://api.nasa.gov/planetary/apod?api_key=';
                const apiKey = "6Scx9GZQX2Nrba4MHyDhDl8YLj1EfovMqb3Tdtdx";

                const title = document.querySelector("#title");
                const copyright = document.querySelector("#copyright");
                const mediaSection = document.querySelector("#media-section");
                const information = document.querySelector("#description-nasa");
                const dateElement = document.querySelector("#date");

                const imageSection = `<a id="hdimg" href="" target="-blank">
                    <div class="image-div">
                    <img id="image_of_the_day" src="" alt="image-by-nasa">
                    </div>
                    </a>`

                const videoSection = `<div class="video-div"> <iframe id="videoLink" src="" frameborder="0"></iframe></div>`


                const dateInput = document.querySelector("#datepicker");
                let newDate = "&date=" + dateInput.value + "&";

                const currentDate = new Date().toISOString().slice(0, 10);
                dateInput.max = currentDate;
                dateInput.min = "1995-06-16";



                function fetchData() {
                    try {
                        fetch(baseUrl + apiKey + newDate)
                            .then(response => response.json())
                            .then(json => {
                                displaydata(json)
                            })
                    } catch (error) {
                        console.error('Fetch failed:', error);
                    }
                }

                function displaydata(data) {
                    title.innerHTML = data.title;
                    if (data.hasOwnProperty("copyright")) {
                        copyright.innerHTML = data.copyright;
                    } else {
                        copyright.innerHTML = ""
                    }

                    if (data.media_type == "video") {
                        mediaSection.innerHTML = videoSection;
                        document.getElementById("videoLink").src = data.url;

                    } else {
                        mediaSection.innerHTML = imageSection;
                        document.getElementById("hdimg").href = data.hdurl;
                        document.getElementById("image_of_the_day").src = data.url;
                    }

                    information.innerHTML = data.explanation
                }

                fetchData()
            }

            nasarequested()
        </script>

    </div>

    <div id="footer"></div>
    <script>
        fetch('footer.html')
            .then(response => response.text())
            .then(html => { document.getElementById('footer').innerHTML = html; });
    </script>
</body>


</html>